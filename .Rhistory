hc %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis(title = NULL) %>%
hc_xAxis(title = NULL)
hc %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis(title = "") %>%
hc_xAxis(title = NULL)
library(openxlsx)
library(openxlsx)
library(highcharter)
library(openxlsx)
library(highcharter)
library(tidyr)
library(magrittr)
colors = c("#2020FA", "#FF9100", '#C3B0EF')
df  <- read.xlsx('data.xlsx', sheet = 1)
View(df)
df  <- read.xlsx('ЦЦИ-Индекс.xlsx', sheet = 1, detectDates = TRUE)
View(df)
df = df[,-1]
df  <- read.xlsx('ЦЦИ-Индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[-1,]
View(df)
df = df[,-1]
View(df)
df[,2:3] <- NULL
View(df)
names(df)[1] <- "date"
df$date <- as.Date(df$date)
df <- df %>% pivot_longer(!date, names_to = "id", values_to = 'value')
View(df)
df  <- read.xlsx('ЦЦИ-Индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[,-1]
df[,2:3] <- NULL
names(df)[1] <- "date"
df <- df %>% pivot_longer(!date, names_to = "date", values_to = 'value')
View(df)
df  <- read.xlsx('ЦЦИ-Индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[-1,]
df = df[,-1]
df[,2:3] <- NULL
names(df)[1] <- "date"
View(df)
df  <- read.xlsx('ЦЦИ-Индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[-1,]
df = df[,-1]
df[,2:3] <- NULL
names(df)[1] <- "index"
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
View(df)
df$date <- as.Date(df$date)
hc = hchart(df, "line", hcaes(x = date, y = value, group = id), color = colors)
hc = hchart(df, "line", hcaes(x = date, y = value, group = index), color = colors)
View(df)
str(df)
head(df)
hc = hchart(df, "line", hcaes(x = date, y = value, group = index), color = colors)
df  <- read.xlsx('ЦЦИ-Индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[-1,]
df = df[,-1]
df[,2:3] <- NULL
names(df)[1] <- "index"
View(df)
226 * 2
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df$date <- as.Date(df$date)
hc = hchart(df, "line", hcaes(x = date, y = value, group = index), color = colors[1:2])
hc %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis(title = "") %>%
hc_xAxis(title = NULL)
hc = hchart(df, "line", hcaes(x = date, y = value, group = index), color = colors[1:2])
hc %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis(title = "индекс, 2021 = 100") %>%
hc_xAxis(title = NULL)
hc$x$conf_opts$lang$months = c("Январь"	,"Февраль",	"Март"	,"Апрель"	,"Май",	"Июнь",
"Июль",	"Август",	"Сентябрь",	"Октябрь",	"Ноябрь",	"Декабрь")
hc$x$conf_opts$lang$shortMonths = c("Янв", 	"Фев",	"Мар",	"Апр",	"Май",	"Июн",	"Июл",	"Авг",	"Сен",	"Окт",	"Ноя",	"Дек")
hc %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis(title = "индекс, 2021 = 100") %>%
hc_xAxis(title = NULL)
rsconnect::setAccountInfo(name='cci-index', token='1B401CCAD0BB648BBFDDB00319DB14F0', secret='a/ns1w7+oa7nZeTOP7mw+dKGqYfsmrBT0Ne4WSb2')
library(rsconnect)
rsconnect::deployApp('cci-index')
library(openxlsx)
library(highcharter)
library(highcharter)
library(tidyr)
library(magrittr)
colors = c("#2020FA", "#FF9100", '#C3B0EF')
df  <- read.xlsx('ЦЦИ-Индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[-1,]
df = df[,-1]
df[,2:3] <- NULL
names(df)[1] <- "index"
View(df)
df = df[,1]
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
library(openxlsx)
library(highcharter)
library(tidyr)
library(magrittr)
colors = c("#2020FA", "#FF9100", '#C3B0EF')
df  <- read.xlsx('ЦЦИ-Индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[-1,]
df = df[,-1]
df[,2:3] <- NULL
names(df)[1] <- "index"
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df$date <- as.Date(df$date)
hc = hchart(df, "line", hcaes(x = date, y = value, group = index), color = colors[1:2])
hc$x$conf_opts$lang$months = c("Январь"	,"Февраль",	"Март"	,"Апрель"	,"Май",	"Июнь",
"Июль",	"Август",	"Сентябрь",	"Октябрь",	"Ноябрь",	"Декабрь")
hc$x$conf_opts$lang$shortMonths = c("Янв", 	"Фев",	"Мар",	"Апр",	"Май",	"Июн",	"Июл",	"Авг",	"Сен",	"Окт",	"Ноя",	"Дек")
hc %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis(title = "2021 = 100") %>%
hc_xAxis(title = NULL)
df  <- read.xlsx('ЦЦИ-Индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[-1,]
df = df[,-1]
df[,2:3] <- NULL
names(df)[1] <- "index"
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df$date <- as.Date(df$date)
hc = hchart(df, "line", hcaes(x = date, y = value, group = index), color = colors[1:2])
hc$x$conf_opts$lang$months = c("Январь"	,"Февраль",	"Март"	,"Апрель"	,"Май",	"Июнь",
"Июль",	"Август",	"Сентябрь",	"Октябрь",	"Ноябрь",	"Декабрь")
hc$x$conf_opts$lang$shortMonths = c("Янв", 	"Фев",	"Мар",	"Апр",	"Май",	"Июн",	"Июл",	"Авг",	"Сен",	"Окт",	"Ноя",	"Дек")
hc %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis(title = "2021 = 100") %>%
hc_xAxis(title = NULL)
install.packages(c("backports", "BiocManager", "brio", "broom", "broom.helpers", "broom.mixed", "bslib", "cachem", "callr", "cli", "codetools", "collapse", "countrycode", "crul", "data.table", "dbplyr", "digest", "fabletools", "farver", "fastmap", "fs", "future", "future.apply", "gamlss", "gbRd", "ggplot2", "gtable", "highr", "htmltools", "httpuv", "httr2", "KernSmooth", "knitr", "labelled", "lattice", "leaflet", "lme4", "matrixStats", "mclust", "minqa", "munsell", "mvtnorm", "openssl", "pkgbuild", "pkgcache", "pkgdown", "processx", "promises", "quantreg", "ragg", "RcppArmadillo", "remotes", "renv", "repr", "reticulate", "rJava", "rlang", "rmarkdown", "rsample", "rsconnect", "RSQLite", "rstudioapi", "sf", "shiny", "shinyWidgets", "sp", "spatstat", "spatstat.explore", "spatstat.linnet", "spatstat.model", "stars", "stringi", "survival", "systemfonts", "terra", "testthat", "textshape", "textshaping", "tinytex", "tseries", "urca", "xfun", "yaml"))
library(openxlsx)
library(highcharter)
library(highcharter)
library(tidyr)
library(magrittr)
colors = c("#2020FA", "#FF9100", '#C3B0EF')
df  <- read.xlsx('ЦЦИ-Сырьевой-индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[1,]
#df = df[,-1]
#df[,2:3] <- NULL
names(df)[1] <- "index"
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df$date <- as.Date(df$date)
#df = df[df$index == "ЦИндекс сырьевых цен ЦЦИ, 01.2022=100",]
df$index = "Индекс сырьевых цен ЦЦИ, янв. 2022 = 100"
df$index <- round(df$index,2)
df2  <- read.xlsx('rub-usd.xlsx', sheet = 1, detectDates = TRUE)
df2 <- df2[df2$date > min(df$date),]
names(df2)[1] <- 'value'
df2$index = 'Курс доллара США к рублю'
hc <- highchart() %>%
hc_xAxis(type = "datetime") %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis_multiples(list(title = list(text = "ЦЦИ сырьевой индекс (Фишер), янв. 2022 = 100"), showFirstLabel = TRUE,showLastLabel=TRUE,opposite = FALSE),
list(title = list(text = "Курс доллара США к рублю"), showLastLabel = FALSE, min = 40, opposite = TRUE)) %>%
hc_add_series(df,type="line", hcaes(x = date, y = value, group=index), color = colors[1]) %>%
hc_add_series(df2,type="line",hcaes(x = date, y = value, group=index),color = colors[2],  yAxis=1, visible = FALSE)
hc$x$conf_opts$lang$months = c("Январь"	,"Февраль",	"Март"	,"Апрель"	,"Май",	"Июнь",
"Июль",	"Август",	"Сентябрь",	"Октябрь",	"Ноябрь",	"Декабрь")
hc$x$conf_opts$lang$shortMonths = c("Янв", 	"Фев",	"Мар",	"Апр",	"Май",	"Июн",	"Июл",	"Авг",	"Сен",	"Окт",	"Ноя",	"Дек")
hc %>%
hc_xAxis(title = NULL)
hc <- highchart() %>%
hc_xAxis(type = "datetime") %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis_multiples(list(title = list(text = "ЦЦИ сырьевой индекс (Фишер), янв. 2022 = 100"), showFirstLabel = TRUE,showLastLabel=TRUE,opposite = FALSE),
list(title = list(text = "Курс доллара США к рублю"), showLastLabel = FALSE, max = 160, opposite = TRUE)) %>%
hc_add_series(df,type="line", hcaes(x = date, y = value, group=index), color = colors[1]) %>%
hc_add_series(df2,type="line",hcaes(x = date, y = value, group=index),color = colors[2],  yAxis=1, visible = FALSE)
hc$x$conf_opts$lang$months = c("Январь"	,"Февраль",	"Март"	,"Апрель"	,"Май",	"Июнь",
"Июль",	"Август",	"Сентябрь",	"Октябрь",	"Ноябрь",	"Декабрь")
hc$x$conf_opts$lang$shortMonths = c("Янв", 	"Фев",	"Мар",	"Апр",	"Май",	"Июн",	"Июл",	"Авг",	"Сен",	"Окт",	"Ноя",	"Дек")
hc %>%
hc_xAxis(title = NULL)
hc <- highchart() %>%
hc_xAxis(type = "datetime") %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis_multiples(list(title = list(text = "ЦЦИ сырьевой индекс (Фишер), янв. 2022 = 100"), showFirstLabel = TRUE,max = 160,showLastLabel=TRUE,opposite = FALSE),
list(title = list(text = "Курс доллара США к рублю"), showLastLabel = FALSE, opposite = TRUE)) %>%
hc_add_series(df,type="line", hcaes(x = date, y = value, group=index), color = colors[1]) %>%
hc_add_series(df2,type="line",hcaes(x = date, y = value, group=index),color = colors[2],  yAxis=1, visible = FALSE)
hc$x$conf_opts$lang$shortMonths = c("Янв", 	"Фев",	"Мар",	"Апр",	"Май",	"Июн",	"Июл",	"Авг",	"Сен",	"Окт",	"Ноя",	"Дек")
hc %>%
hc_xAxis(title = NULL)
View(df)
max(df$value)
hc <- highchart() %>%
hc_xAxis(type = "datetime") %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis_multiples(list(title = list(text = "ЦЦИ сырьевой индекс (Фишер), янв. 2022 = 100"), showFirstLabel = TRUE, max = 140,showLastLabel=TRUE,opposite = FALSE),
list(title = list(text = "Курс доллара США к рублю"), showLastLabel = FALSE, opposite = TRUE)) %>%
hc_add_series(df,type="line", hcaes(x = date, y = value, group=index), color = colors[1]) %>%
hc_add_series(df2,type="line",hcaes(x = date, y = value, group=index),color = colors[2],  yAxis=1, visible = FALSE)
hc
hc$x$conf_opts$lang$months = c("Январь"	,"Февраль",	"Март"	,"Апрель"	,"Май",	"Июнь",
"Июль",	"Август",	"Сентябрь",	"Октябрь",	"Ноябрь",	"Декабрь")
hc$x$conf_opts$lang$shortMonths = c("Янв", 	"Фев",	"Мар",	"Апр",	"Май",	"Июн",	"Июл",	"Авг",	"Сен",	"Окт",	"Ноя",	"Дек")
hc
library(openxlsx)
library(highcharter)
library(tidyr)
library(magrittr)
colors = c("#2020FA", "#FF9100", '#C3B0EF')
df  <- read.xlsx('ЦЦИ-Сырьевой-индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[1,]
#df = df[,-1]
#df[,2:3] <- NULL
names(df)[1] <- "index"
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df$date <- as.Date(df$date)
#df = df[df$index == "ЦИндекс сырьевых цен ЦЦИ, 01.2022=100",]
df$index = "Индекс сырьевых цен ЦЦИ, янв. 2022 = 100"
df$value <- round(as.numeric(df$value,2))
df2  <- read.xlsx('rub-usd.xlsx', sheet = 1, detectDates = TRUE)
df2 <- df2[df2$date > min(df$date),]
names(df2)[1] <- 'value'
df2$index = 'Курс доллара США к рублю'
hc <- highchart() %>%
hc_xAxis(type = "datetime") %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis_multiples(list(title = list(text = "ЦЦИ сырьевой индекс (Фишер), янв. 2022 = 100"), showFirstLabel = TRUE, max = 140,showLastLabel=TRUE,opposite = FALSE),
list(title = list(text = "Курс доллара США к рублю"), showLastLabel = FALSE, opposite = TRUE)) %>%
hc_add_series(df,type="line", hcaes(x = date, y = value, group=index), color = colors[1]) %>%
hc_add_series(df2,type="line",hcaes(x = date, y = value, group=index),color = colors[2],  yAxis=1, visible = FALSE)
hc$x$conf_opts$lang$months = c("Январь"	,"Февраль",	"Март"	,"Апрель"	,"Май",	"Июнь",
"Июль",	"Август",	"Сентябрь",	"Октябрь",	"Ноябрь",	"Декабрь")
hc$x$conf_opts$lang$shortMonths = c("Янв", 	"Фев",	"Мар",	"Апр",	"Май",	"Июн",	"Июл",	"Авг",	"Сен",	"Окт",	"Ноя",	"Дек")
hc
df  <- read.xlsx('ЦЦИ-Сырьевой-индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[1,]
#df = df[,-1]
#df[,2:3] <- NULL
names(df)[1] <- "index"
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df$date <- as.Date(df$date)
#df = df[df$index == "ЦИндекс сырьевых цен ЦЦИ, 01.2022=100",]
df$index = "Индекс сырьевых цен ЦЦИ, янв. 2022 = 100"
df$value <- round(as.numeric(df$value,2))
View(df)
df$value
df  <- read.xlsx('ЦЦИ-Сырьевой-индекс.xlsx', sheet = 1, detectDates = TRUE)
df = df[1,]
#df = df[,-1]
#df[,2:3] <- NULL
names(df)[1] <- "index"
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df$date <- as.Date(df$date)
#df = df[df$index == "ЦИндекс сырьевых цен ЦЦИ, 01.2022=100",]
df$index = "Индекс сырьевых цен ЦЦИ, янв. 2022 = 100"
df$value
round(df$value,2)
df$value <- round(df$value,2)
df$value
styler:::style_selection()
View(df)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
library(openxlsx)
library(highcharter)
library(tidyr)
library(magrittr)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
View(df)
df2 = df[2,]
View(df2)
df1 = df[1,]
View(df1)
names(df)[1] <- "index"
View(df1)
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
View(df1)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
df_index = df[1,]
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
df_index = df[1,]
View(df_index)
names(df_index)[1] <- "index"
df_index <- df_index %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df_index$date <- as.Date(df_index$date)
df_index$index = "Индекс сырьевых цен ЦЦИ, янв. 2022 = 100"
df_index$value <- round(df_index$value,2)
df_usdrub = df[2,]
View(df_usdrub)
names(df_usdrub)[1] <- 'value'
df_usdrub$index = 'Курс доллара США к рублю'
View(df_usdrub)
View(df_index)
df_usdrub <- df_usdrub %>% pivot_longer(!index, names_to = "date", values_to = 'value')
View(df_index)
names(df_usdrub)[1] <- 'index'
View(df_usdrub)
df_usdrub <- df_usdrub %>% pivot_longer(!index, names_to = "date", values_to = 'value')
View(df_usdrub)
View(df_usdrub)
?йгфкещ згидшыр
?quarto publish
install.packages('quarto')
library(quarto)
library(openxlsx)
library(highcharter)
library(tidyr)
library(magrittr)
RUST_BACKTRACE=1
QUARTO_PUB_AUTH_TOKEN="7a243e2a-f901-4cf5-9604-e48401f115db"
QUARTO_PUB_AUTH_TOKEN="7a243e2a-f901-4cf5-9604-e48401f115db"
QUARTO_PUB_AUTH_TOKEN = "7a243e2a-f901-4cf5-9604-e48401f115db"
install.packages("tidyverse")
install.packages("palmerpenguins")
quarto publish
View(df)
?highchart
library(openxlsx)
library(highcharter)
library(tidyr)
library(magrittr)
colors = c("#2354d6", "#FF9500", '#82096c', '#d1e5ff')
# прочитать и преобразовать файл Excel с данными
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
df_index = df[1,]
#df = df[,-1]
#df[,2:3] <- NULL
names(df_index)[1] <- "index"
df_index <- df_index %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df_index$date <- as.Date(df_index$date)
#df = df[df$index == "ЦИндекс сырьевых цен ЦЦИ, 01.2022=100",]
df_index$index = 'Индекс сырьевых цен ЦЦИ, янв. 2022 = 100'
df_index$value <- round(df_index$value,2)
# прочитать файл с курсом RUB/USD
# df2  <- read.xlsx('rub-usd.xlsx', sheet = 1, detectDates = TRUE)
# df2 <- df2[df2$date > min(df$date),]
df_usdrub = df[2,]
names(df_usdrub)[1] <- 'index'
df_usdrub <- df_usdrub %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df_usdrub$date <- as.Date(df_usdrub$date)
df_usdrub$index = 'USD/RUB, рублей за доллар'
df_usdrub$value <- round(df_usdrub$value,2)
# Non-oil index
df_noil_index = df[4,]
names(df_noil_index)[1] <- 'index'
df_noil_index <- df_noil_index %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df_noil_index$date <- as.Date(df_noil_index$date)
df_noil_index$index = 'Индекс сырьевых цен ненефтяного экспорта, янв. 2022 = 100'
df_noil_index$value <- round(df_noil_index$value,2)
# построить график highcharts
hc <- highchart() %>%
hc_xAxis(type = "datetime") %>%
hc_exporting(enabled = TRUE) %>%
hc_yAxis_multiples(
list(title = list(text = "Индекс сырьевых цен ЦЦИ, янв. 2022 = 100"), showFirstLabel = TRUE, max = 150, showLastLabel=TRUE,opposite = FALSE),
list(title = list(text = "USD/RUB, рублей за доллар"), showLastLabel = FALSE, opposite = TRUE)) %>%
hc_add_series(df_index,type="line", hcaes(x = date, y = value, group=index), color = colors[1]) %>%
hc_add_series(df_usdrub,type="line", hcaes(x = date, y = value, group=index), color = colors[2],  yAxis=1, visible = FALSE) %>%
hc_add_series(df_noil_index,type="line", hcaes(x = date, y = value, group=index), color = colors[3], visible = FALSE)
# поменять названия месяцев на русские. по умолчанию - на английском
hc$x$conf_opts$lang$months = c("Январь"	,"Февраль",	"Март"	,"Апрель"	,"Май",	"Июнь", "Июль",	"Август",	"Сентябрь",	"Октябрь",	"Ноябрь",	"Декабрь")
hc$x$conf_opts$lang$shortMonths = c("Янв", 	"Фев",	"Мар",	"Апр",	"Май",	"Июн",	"Июл",	"Авг",	"Сен",	"Окт",	"Ноя",	"Дек")
hc
?hc
?highchart
?highcharts
export QUARTO_PUB_AUTH_TOKEN="qpa_W8kL2HhGzPAfHGzOOFVBGWvjVFtopqs17dsvRrrDj0iO1pH1KlTuscaZC2L1Spuu"
QUARTO_PUB_AUTH_TOKEN="qpa_W8kL2HhGzPAfHGzOOFVBGWvjVFtopqs17dsvRrrDj0iO1pH1KlTuscaZC2L1Spuu"
library(quarto)
library(devtools)
?transpose
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
library(openxlsx)
library(highcharter)
library(tidyr)
library(magrittr)
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
df <- df %>% pivot_longer(!index, names_to = "date", values_to = 'value')
df <- transpose(df)
df <- t(df)
View(df)
df <- df %>% rownames_to_column() %>% pivot_longer(!rowname, names_to = "date", values_to = 'value')
?rownames_to_column()
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
View(df)
df <- df %>% pivot_longer(cols = X1, names_to = "date", values_to = 'value')
View(df)
View(df)
?read.xlsx
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
df <- df %>% pivot_longer(cols = -X1, names_to = "date", values_to = 'value')
View(df)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
View(df)
df_factor <- df[5-14,] %>% pivot_longer(cols = -X1, names_to = "date", values_to = 'value')
View(df_factor)
df_factor <- df[5:14,] %>% pivot_longer(cols = -X1, names_to = "date", values_to = 'value')
View(df_factor)
df_factor <- t(df[5:14,])
View(df_factor)
install.packages(janitor)
install.packages('janitor')
labrary(janitor)
library(janitor)
df_factor <- t(df[5:14,]) %>% row_to_names(row_number = 1)
View(df_factor)
df_factor <- as.DataFrame(t(df[5:14,]) %>% row_to_names(row_number = 1))
df_factor <- as.data.frame(t(df[5:14,]) %>% row_to_names(row_number = 1))
View(df_factor)
df_factor <- as.data.frame(t(df) %>% row_to_names(row_number = 1))
View(df_factor)
View(df_index)
View(df)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = FALSE)
View(df)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
index(df_factor)
?index
View(df_factor)
?read.xlsx
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE, colNames = FALSE, rowNames = TRUE)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE, colNames = FALSE, rowNames = FALSE)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE, colNames = TRUE, rowNames = FALSE)
View(df)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = FALSE, colNames = FALSE, rowNames = FALSE)
View(df)
df_factor <- as.data.frame(t(df) %>% row_to_names(row_number = 1))
View(df_factor)
df_factor$date <- as.Date(df_factor$date)
View(df_factor)
df_factor$date <- as.Date(df_factor$   )
df_factor <- as.data.frame(t(df) %>% row_to_names(row_number = 1))
View(df_factor)
df_factor$date <- as.Date(df_factor[,1]
View(df_factor)
df_factor$date <- as.Date(df_factor[,1])
View(df_factor)
df_factor$date <- as.Date(df_factor[1])
df_factor$date <- as.Date(df_factor[1,])
df_factor$date <- as.Date(df_factor[,1])
df_factor$date <- as.Date(df_factor$date)
df_factor$date <- as.Date(df_factor$1)
View(df_factor)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
df_factor <- as.data.frame(t(df) %>% row_to_names(row_number = 1))
View(df_factor)
row.names(df_factor)
?haces
?hcaes
?aes
df_factor$date <- row.names(df_factor)
View(df_factor)
View(df_factor)
View(df_factor)
df_factor <- subset(df_factor, df_factor$date>'2021-01-01')
View(df_factor)
View(df_factor)
View(df_factor)
reset_index(df_factor)
rownames(df_factor) <- NULL
View(df_factor)
View(df_factor)
View(df_index)
?highchart
df_factor <- df %>% row_to_names(row_number = 1) %>% pivot_longer(-X1, names_to = "date", values_to = 'value')
df_factor <- df %>% pivot_longer(-X1, names_to = "date", values_to = 'value')
View(df_factor)
df_factor <- df[5:14,] %>% pivot_longer(-X1, names_to = "date", values_to = 'value')
df_factor <- df %>% pivot_longer(-X1, names_to = "date", values_to = 'value')
View(df)
df_factor <- df[5:14,]
df_factor <- df %>% pivot_longer(-X1, names_to = "date", values_to = 'value')
df_factor <- df[5:14,] %>% pivot_longer(-X1, names_to = "date", values_to = 'value')
?hcaes
View(df_index)
View(df_factor)
View(df_index)
View(df_usdrub)
df_diff <- df[5,] %>% pivot_longer(-X1, names_to = "date", values_to = 'value')
View(df_diff)
View(df)
df_diff <- df[5,] %>% pivot_longer(-X1, names_to = "date", values_to = 'value')
df_diif$date <- as.Date(df_diff$date)
?hc_add_series
View(df_diff)
df_diif$date <- as.Date(df_diff$date)
df_diff$date <- as.Date(df_diff$date)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
df_diff <- df[5,] %>% pivot_longer(-X1, names_to = "date", values_to = 'value')
df_diff$date <- as.Date(df_diff$date)
df_diff <- subset(df_diff, df_diff$date>'2023-01-01')
View(df_diff)
install.packages("rmarkdown")
library(rmarkdown)
library(quarto)
QUARTO_PUB_AUTH_TOKEN = "qpa_W8kL2HhGzPAfHGzOOFVBGWvjVFtopqs17dsvRrrDj0iO1pH1KlTuscaZC2L1Spuu"
quarto_preview(index.qmd)
quarto_inspect()
quarto_path(C:\Users\andor\YandexDisk\CCI-index)
quarto_path(C:/Users/andor/YandexDisk/CCI-index)
quarto_path("C:/Users/andor/YandexDisk/CCI-index")
quarto_path(C:/Users/andor/YandexDisk/CCI-index)
?quarto_path
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
library(openxlsx)
library(highcharter)
library(tidyr)
library(magrittr)
df  <- read.xlsx('ЦЦИ Сырьевой индекс.xlsx', sheet = 1, detectDates = TRUE)
View(df)
View(df)
